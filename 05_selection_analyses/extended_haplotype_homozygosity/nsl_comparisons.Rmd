---
title: "Bombus population genomics"
output: nsl_comparisons.html
author: Joe Colgan, Yannick Wurm http://wurmlab.com
---

## Introduction:
The following script investigates the relationship between the length of a gene and assigned median and maximum |nsl| scores per genes. In addition, this scripts investigates the relationship between gene length and the number of gene ontology terms assigned to each individual gene.
This script outputs scatterplots.

```{r, message = FALSE}
## Read in input file:
data <- read.table(file = "./input_for_R.tmp", 
                   header = FALSE)

## Rename columns:
colnames(data) <- c("locus",
                    "length",
                    "median_nsl",
                    "nsl_score",
                    "num_of_terms")
```

Examine the relationship between length and nsl scores (median and max per gene)

```{r, message = FALSE}
## Correlation between gene length and median nsl per gene:
cor.test(data$length,
         data$median_nsl)

## Plot length vs. median nsl per gene:
require(ggplot2)
## Generate scatterplot:
ggplot(data,
       aes(x = length,
           y = median_nsl)) +
        xlab("Gene length (bp)") +
        ylab("Median |nsl| score") +
        geom_point() +
        theme_bw()

## Correlation between gene length and max nsl score per gene:
cor.test(data$length,
         data$nsl_score)

## Generate scatterplot:
ggplot(data,
       aes(x = length,
           y = nsl_score)) +
        xlab("Gene length (bp)") +
        ylab("|nsl| score") +
        geom_point() +
        theme_bw()
```

Explore relationship between gene length and gene ontology term numbers:

```{r, message = FALSE}
## Check correlation:
cor.test(data$length,
         data$num_of_terms)

## Generate plot:
ggplot(data,
       aes(x = length,
           y = num_of_terms)) +
        xlab("Gene length (bp)") +
        ylab("Number of annotated GO terms") +
        geom_point() +
        theme_bw()
```
```{r, message = FALSE}
## Check correlation:
cor.test(data$nsl_score,
         data$num_of_terms)

## Generate plot:
ggplot(data,
       aes(x = nsl_score,
           y = num_of_terms)) +
        xlab("|nsl| score") +
        ylab("Number of annotated GO terms") +
        geom_point() +
        theme_bw()
```
Run lintr:
```{r, message = FALSE}
lintr::lint("./nsl_comparisons.Rmd")
```
Write output to file:

```{r, message = FALSE}
render("nsl_comparisons.Rmd",
       output_format = "pdf_document")
```


